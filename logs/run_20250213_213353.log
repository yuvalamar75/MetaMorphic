2025-02-13 21:33:53 [INFO] MainScript: Loading configuration from /Users/yuval/MetaMorphic/configs/test_real_data.yaml
2025-02-13 21:33:53 [INFO] MainScript.ConfigParser: ConfigParser initialized with config path: /Users/yuval/MetaMorphic/configs/test_real_data.yaml
2025-02-13 21:33:53 [INFO] MainScript.ConfigParser: Attempting to load configuration from: /Users/yuval/MetaMorphic/configs/test_real_data.yaml
2025-02-13 21:33:53 [INFO] MainScript.ConfigParser: Configuration loaded successfully.
2025-02-13 21:33:53 [INFO] MainScript.ConfigParser: Retrieving entire 'settings' dictionary...
2025-02-13 21:33:53 [INFO] MainScript.ConfigParser: Retrieving files configuration from 'files'...
2025-02-13 21:33:53 [INFO] MainScript.ConfigParser: Retrieving joins configuration from 'joins'...
2025-02-13 21:33:53 [INFO] MainScript: Output file: /Users/yuval/MetaMorphic/output/real_data_1
2025-02-13 21:33:53 [INFO] MainScript: Files definition:
[{'name': 'CAPS_before', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'CAPS', 'transformations': [{'select_columns': ['(1) B1 - זכרונות חודרניים - חומרה', '(2) B2 - חלומות מטרידים - חומרה', '(3) B3 - תגובות דיסוציאטיביות - חומרה', '(4) B4 - מצוקה פסיכולוגית בתגובה לרמזים - חומרה', '(5) B5 - תגובה גופנית לרמזים - חומרה', '(6) C1 - הימנעות מזכרונות, מחשבות, רגשות - חומרה', '(7) C2 - הימנעות מתזכורות חיצוניות - חומרה', '(8) D1 - חוסר יכולת לזכור חלקים חשובים מהאירוע - חומרה', '(9) D2 - ציפיות או אמונות שליליות מוגזמות - חומרה', '(10) D3 - קוגניציות מעוותות המובילות לאשמה - חומרה', '(11) D4 - מצב רגשי שלילי מתמשך - חומרה', '(12) D5 - עניין מופחת בהשתתפות בפעילויות - חומרה', '(13) D6 - תחושות של ניתוק או ניכור כלפי הזולת - חומרה', '(14) D7 - חוסר יכולת מתמשך לחוות רגשות חיוביים - חומרה', '(15) E1 - התנהגות רגזנית והתפרצויות זעם - חומרה', '(16) E2 - התנהגות של הרס עצמי או חוסר זהירות - חומרה', '(17) E3 - ערנות יתר - חומרה', '(18) E4 - תגובת בהלה מוגזמת - חומרה', '(19) E5 - קשיים בריכוז - חומרה', '(20) E6 - הפרעות בשינה - חומרה', '(21) האם הייתה הופעת סימפטומים מושהית (6 חודשים מהאירוע הטראומטי או יותר)?', '(22) האם ההפרעה נמשכת יותר מחודש אחד?', '(23) G1 - מצוקה סובייקטיבית - חומרה', '(24) G2 - ליקוי בתפקוד החברתי - חומרה', '(25) G3 - ליקוי בתפקוד התעסוקתי - חומרה', '(26) תוקף כללי', '(27) חומרה כללית', '(28) שיפור כללי', '(29) 1 - דה-פרסונליזציה - חומרה', '(30) 2 - דה-ריאליזציה - חומרה', 'CAPS', 'שלב בטיפולים', 'קוד מטופל (9 ספרות)']}, {'filter_rows': {'column': 'שלב בטיפולים', 'operator': 'is_in', 'values': ['לפני טיפול']}}], 'filter_rows': {}}, {'name': 'PTSD_partA_before', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partA', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}, {'name': 'PTSD_partB_before', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partB', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}, {'name': 'CAPS_after', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'CAPS', 'transformations': [{'select_columns': ['(1) B1 - זכרונות חודרניים - חומרה', '(2) B2 - חלומות מטרידים - חומרה', '(3) B3 - תגובות דיסוציאטיביות - חומרה', '(4) B4 - מצוקה פסיכולוגית בתגובה לרמזים - חומרה', '(5) B5 - תגובה גופנית לרמזים - חומרה', '(6) C1 - הימנעות מזכרונות, מחשבות, רגשות - חומרה', '(7) C2 - הימנעות מתזכורות חיצוניות - חומרה', '(8) D1 - חוסר יכולת לזכור חלקים חשובים מהאירוע - חומרה', '(9) D2 - ציפיות או אמונות שליליות מוגזמות - חומרה', '(10) D3 - קוגניציות מעוותות המובילות לאשמה - חומרה', '(11) D4 - מצב רגשי שלילי מתמשך - חומרה', '(12) D5 - עניין מופחת בהשתתפות בפעילויות - חומרה', '(13) D6 - תחושות של ניתוק או ניכור כלפי הזולת - חומרה', '(14) D7 - חוסר יכולת מתמשך לחוות רגשות חיוביים - חומרה', '(15) E1 - התנהגות רגזנית והתפרצויות זעם - חומרה', '(16) E2 - התנהגות של הרס עצמי או חוסר זהירות - חומרה', '(17) E3 - ערנות יתר - חומרה', '(18) E4 - תגובת בהלה מוגזמת - חומרה', '(19) E5 - קשיים בריכוז - חומרה', '(20) E6 - הפרעות בשינה - חומרה', '(21) האם הייתה הופעת סימפטומים מושהית (6 חודשים מהאירוע הטראומטי או יותר)?', '(22) האם ההפרעה נמשכת יותר מחודש אחד?', '(23) G1 - מצוקה סובייקטיבית - חומרה', '(24) G2 - ליקוי בתפקוד החברתי - חומרה', '(25) G3 - ליקוי בתפקוד התעסוקתי - חומרה', '(26) תוקף כללי', '(27) חומרה כללית', '(28) שיפור כללי', '(29) 1 - דה-פרסונליזציה - חומרה', '(30) 2 - דה-ריאליזציה - חומרה', 'CAPS', 'שלב בטיפולים', 'קוד מטופל (9 ספרות)']}, {'filter_rows': {'column': 'שלב בטיפולים', 'operator': 'is_in', 'values': ['לאחר טיפול']}}], 'filter_rows': {}}, {'name': 'PTSD_partA_after', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partA', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}, {'name': 'PTSD_partB_after', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partB', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}]
2025-02-13 21:33:53 [INFO] MainScript: Join steps:
[{'source': 'CAPS_before', 'join_with': 'PTSD_partA_before', 'join_type': 'left', 'join_on': [{'CAPS_before': 'קוד מטופל (9 ספרות)'}, {'PTSD_partA_before': 'קוד אישי'}]}, {'source': 'CAPS_before', 'join_with': 'PTSD_partB_before', 'join_type': 'left', 'join_on': [{'CAPS_before': 'קוד מטופל (9 ספרות)'}, {'PTSD_partB_before': 'קוד אישי'}]}, {'source': 'CAPS_after', 'join_with': 'PTSD_partA_after', 'join_type': 'left', 'join_on': [{'CAPS_after': 'קוד מטופל (9 ספרות)'}, {'PTSD_partA_after': 'קוד אישי'}]}, {'source': 'CAPS_after', 'join_with': 'PTSD_partB_before', 'join_type': 'left', 'join_on': [{'CAPS_before': 'קוד מטופל (9 ספרות)'}, {'PTSD_partB_before': 'קוד אישי'}]}, {'source': None, 'join_with': None, 'join_type': None, 'join_on': {}}]
2025-02-13 21:33:53 [INFO] MainScript.DataLoader: Loading data from /Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx sheet name : CAPS as xlsx 
2025-02-13 21:33:53 [ERROR] MainScript.DataLoader: Error loading data from /Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx sheet name : CAPS : Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
Traceback (most recent call last):
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1004, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/yuval/MetaMorphic/src/data_loader.py", line 16, in load_data
    df = pd.read_excel(file_path, sheet_name=sheet,engine='openpyxl')
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 457, in read_excel
    io = ExcelFile(io, storage_options=storage_options, engine=engine)
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/site-packages/pandas/io/excel/_base.py", line 1419, in __init__
    self._reader = self._engines[engine](self._io, storage_options=storage_options)
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/site-packages/pandas/io/excel/_openpyxl.py", line 524, in __init__
    import_optional_dependency("openpyxl")
  File "/Users/yuval/.conda/envs/DS/lib/python3.10/site-packages/pandas/compat/_optional.py", line 141, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
