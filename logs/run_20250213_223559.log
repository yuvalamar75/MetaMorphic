2025-02-13 22:35:59 [INFO] MainScript: Loading configuration from /Users/yuval/MetaMorphic/configs/test_real_data.yaml
2025-02-13 22:35:59 [INFO] MainScript.ConfigParser: ConfigParser initialized with config path: /Users/yuval/MetaMorphic/configs/test_real_data.yaml
2025-02-13 22:35:59 [INFO] MainScript.ConfigParser: Attempting to load configuration from: /Users/yuval/MetaMorphic/configs/test_real_data.yaml
2025-02-13 22:35:59 [INFO] MainScript.ConfigParser: Configuration loaded successfully.
2025-02-13 22:35:59 [INFO] MainScript.ConfigParser: Retrieving entire 'settings' dictionary...
2025-02-13 22:35:59 [INFO] MainScript.ConfigParser: Retrieving files configuration from 'files'...
2025-02-13 22:35:59 [INFO] MainScript.ConfigParser: Retrieving joins configuration from 'joins'...
2025-02-13 22:35:59 [INFO] MainScript: Output file: /Users/yuval/MetaMorphic/output/real_data_1
2025-02-13 22:35:59 [INFO] MainScript: Files definition:
[{'name': 'CAPS_before', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'CAPS', 'transformations': [{'select_columns': ['(1) B1 - זכרונות חודרניים - חומרה', '(2) B2 - חלומות מטרידים - חומרה', '(3) B3 - תגובות דיסוציאטיביות - חומרה', '(4) B4 - מצוקה פסיכולוגית בתגובה לרמזים - חומרה', '(5) B5 - תגובה גופנית לרמזים - חומרה', '(6) C1 - הימנעות מזכרונות, מחשבות, רגשות - חומרה', '(7) C2 - הימנעות מתזכורות חיצוניות - חומרה', '(8) D1 - חוסר יכולת לזכור חלקים חשובים מהאירוע - חומרה', '(9) D2 - ציפיות או אמונות שליליות מוגזמות - חומרה', '(10) D3 - קוגניציות מעוותות המובילות לאשמה - חומרה', '(11) D4 - מצב רגשי שלילי מתמשך - חומרה', '(12) D5 - עניין מופחת בהשתתפות בפעילויות - חומרה', '(13) D6 - תחושות של ניתוק או ניכור כלפי הזולת - חומרה', '(14) D7 - חוסר יכולת מתמשך לחוות רגשות חיוביים - חומרה', '(15) E1 - התנהגות רגזנית והתפרצויות זעם - חומרה', '(16) E2 - התנהגות של הרס עצמי או חוסר זהירות - חומרה', '(17) E3 - ערנות יתר - חומרה', '(18) E4 - תגובת בהלה מוגזמת - חומרה', '(19) E5 - קשיים בריכוז - חומרה', '(20) E6 - הפרעות בשינה - חומרה', '(21) האם הייתה הופעת סימפטומים מושהית (6 חודשים מהאירוע הטראומטי או יותר)?', '(22) האם ההפרעה נמשכת יותר מחודש אחד?', '(23) G1 - מצוקה סובייקטיבית - חומרה', '(24) G2 - ליקוי בתפקוד החברתי - חומרה', '(25) G3 - ליקוי בתפקוד התעסוקתי - חומרה', '(26) תוקף כללי', '(27) חומרה כללית', '(28) שיפור כללי', '(29) 1 - דה-פרסונליזציה - חומרה', '(30) 2 - דה-ריאליזציה - חומרה', 'CAPS', 'שלב בטיפולים', 'קוד מטופל (9 ספרות)']}, {'filter_rows': {'column': 'שלב בטיפולים', 'operator': 'is_in', 'values': ['לפני טיפול']}}], 'filter_rows': {}}, {'name': 'PTSD_partA_before', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partA', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}, {'name': 'PTSD_partB_before', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partB', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}, {'name': 'CAPS_after', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'CAPS', 'transformations': [{'select_columns': ['(1) B1 - זכרונות חודרניים - חומרה', '(2) B2 - חלומות מטרידים - חומרה', '(3) B3 - תגובות דיסוציאטיביות - חומרה', '(4) B4 - מצוקה פסיכולוגית בתגובה לרמזים - חומרה', '(5) B5 - תגובה גופנית לרמזים - חומרה', '(6) C1 - הימנעות מזכרונות, מחשבות, רגשות - חומרה', '(7) C2 - הימנעות מתזכורות חיצוניות - חומרה', '(8) D1 - חוסר יכולת לזכור חלקים חשובים מהאירוע - חומרה', '(9) D2 - ציפיות או אמונות שליליות מוגזמות - חומרה', '(10) D3 - קוגניציות מעוותות המובילות לאשמה - חומרה', '(11) D4 - מצב רגשי שלילי מתמשך - חומרה', '(12) D5 - עניין מופחת בהשתתפות בפעילויות - חומרה', '(13) D6 - תחושות של ניתוק או ניכור כלפי הזולת - חומרה', '(14) D7 - חוסר יכולת מתמשך לחוות רגשות חיוביים - חומרה', '(15) E1 - התנהגות רגזנית והתפרצויות זעם - חומרה', '(16) E2 - התנהגות של הרס עצמי או חוסר זהירות - חומרה', '(17) E3 - ערנות יתר - חומרה', '(18) E4 - תגובת בהלה מוגזמת - חומרה', '(19) E5 - קשיים בריכוז - חומרה', '(20) E6 - הפרעות בשינה - חומרה', '(21) האם הייתה הופעת סימפטומים מושהית (6 חודשים מהאירוע הטראומטי או יותר)?', '(22) האם ההפרעה נמשכת יותר מחודש אחד?', '(23) G1 - מצוקה סובייקטיבית - חומרה', '(24) G2 - ליקוי בתפקוד החברתי - חומרה', '(25) G3 - ליקוי בתפקוד התעסוקתי - חומרה', '(26) תוקף כללי', '(27) חומרה כללית', '(28) שיפור כללי', '(29) 1 - דה-פרסונליזציה - חומרה', '(30) 2 - דה-ריאליזציה - חומרה', 'CAPS', 'שלב בטיפולים', 'קוד מטופל (9 ספרות)']}, {'filter_rows': {'column': 'שלב בטיפולים', 'operator': 'is_in', 'values': ['לאחר טיפול']}}], 'filter_rows': {}}, {'name': 'PTSD_partA_after', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partA', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}, {'name': 'PTSD_partB_after', 'path': '/Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx', 'sheet': 'PTSD_partB', 'transformations': [{'filter_rows': {'column': 'אנא בחר/י את שלב הטיפולים בו את/ה נמצא/ת בעת מילוי השאלון', 'operator': 'is_in', 'values': ['לפני טיפול ראשון בתא לחץ']}}], 'filter_rows': {}}]
2025-02-13 22:35:59 [INFO] MainScript: Join steps:
[{'source': 'CAPS_before', 'join_with': 'PTSD_partA_before', 'join_type': 'left', 'join_on': [{'CAPS_before': 'קוד מטופל (9 ספרות)'}, {'PTSD_partA_before': 'קוד אישי'}]}, {'source': 'CAPS_before', 'join_with': 'PTSD_partB_before', 'join_type': 'left', 'join_on': [{'CAPS_before': 'קוד מטופל (9 ספרות)'}, {'PTSD_partB_before': 'קוד אישי'}]}, {'source': 'CAPS_after', 'join_with': 'PTSD_partA_after', 'join_type': 'left', 'join_on': [{'CAPS_after': 'קוד מטופל (9 ספרות)'}, {'PTSD_partA_after': 'קוד אישי'}]}, {'source': 'CAPS_after', 'join_with': 'PTSD_partB_before', 'join_type': 'left', 'join_on': [{'CAPS_before': 'קוד מטופל (9 ספרות)'}, {'PTSD_partB_before': 'קוד אישי'}]}, {'source': None, 'join_with': None, 'join_type': None, 'join_on': {}}]
2025-02-13 22:35:59 [INFO] MainScript.DataLoader: Loading data from /Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx sheet name : CAPS as xlsx 
2025-02-13 22:36:00 [INFO] MainScript.DataLoader: Successfully loaded data from /Users/yuval/Documents/metamorphic_data/Questionnaires.xlsx sheet name : CAPS
2025-02-13 22:36:00 [INFO] MainScript.Transformer: Starting transformations...
2025-02-13 22:36:00 [INFO] MainScript.Transformer: Applying transformation 'select_columns' with parameters ['(1) B1 - זכרונות חודרניים - חומרה', '(2) B2 - חלומות מטרידים - חומרה', '(3) B3 - תגובות דיסוציאטיביות - חומרה', '(4) B4 - מצוקה פסיכולוגית בתגובה לרמזים - חומרה', '(5) B5 - תגובה גופנית לרמזים - חומרה', '(6) C1 - הימנעות מזכרונות, מחשבות, רגשות - חומרה', '(7) C2 - הימנעות מתזכורות חיצוניות - חומרה', '(8) D1 - חוסר יכולת לזכור חלקים חשובים מהאירוע - חומרה', '(9) D2 - ציפיות או אמונות שליליות מוגזמות - חומרה', '(10) D3 - קוגניציות מעוותות המובילות לאשמה - חומרה', '(11) D4 - מצב רגשי שלילי מתמשך - חומרה', '(12) D5 - עניין מופחת בהשתתפות בפעילויות - חומרה', '(13) D6 - תחושות של ניתוק או ניכור כלפי הזולת - חומרה', '(14) D7 - חוסר יכולת מתמשך לחוות רגשות חיוביים - חומרה', '(15) E1 - התנהגות רגזנית והתפרצויות זעם - חומרה', '(16) E2 - התנהגות של הרס עצמי או חוסר זהירות - חומרה', '(17) E3 - ערנות יתר - חומרה', '(18) E4 - תגובת בהלה מוגזמת - חומרה', '(19) E5 - קשיים בריכוז - חומרה', '(20) E6 - הפרעות בשינה - חומרה', '(21) האם הייתה הופעת סימפטומים מושהית (6 חודשים מהאירוע הטראומטי או יותר)?', '(22) האם ההפרעה נמשכת יותר מחודש אחד?', '(23) G1 - מצוקה סובייקטיבית - חומרה', '(24) G2 - ליקוי בתפקוד החברתי - חומרה', '(25) G3 - ליקוי בתפקוד התעסוקתי - חומרה', '(26) תוקף כללי', '(27) חומרה כללית', '(28) שיפור כללי', '(29) 1 - דה-פרסונליזציה - חומרה', '(30) 2 - דה-ריאליזציה - חומרה', 'CAPS', 'שלב בטיפולים', 'קוד מטופל (9 ספרות)']
2025-02-13 22:36:00 [INFO] MainScript.Transformer: slice data frame : before sliceing 38 columns
2025-02-13 22:36:00 [ERROR] MainScript.Transformer: Columns not found in DataFrame: ['CAPS']
2025-02-13 22:36:00 [ERROR] MainScript.Transformer: Error applying transformation 'select_columns': Columns not found: ['CAPS']
Traceback (most recent call last):
  File "/Users/yuval/MetaMorphic/src/transformer.py", line 108, in run_transformations
    method(params_normalized)
  File "/Users/yuval/MetaMorphic/src/transformer.py", line 39, in select_columns
    raise ValueError(f"Columns not found: {missing_columns}")
ValueError: Columns not found: ['CAPS']
